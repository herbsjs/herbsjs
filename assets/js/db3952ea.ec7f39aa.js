"use strict";(self.webpackChunkherbjs_website=self.webpackChunkherbjs_website||[]).push([[8983],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return h}});var s=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,s,r=function(e,t){if(null==e)return{};var n,s,r={},a=Object.keys(e);for(s=0;s<a.length;s++)n=a[s],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)n=a[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=s.createContext({}),u=function(e){var t=s.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return s.createElement(c.Provider,{value:t},e.children)},l={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},d=s.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=u(n),h=r,f=d["".concat(c,".").concat(h)]||d[h]||l[h]||a;return n?s.createElement(f,i(i({ref:t},p),{},{components:n})):s.createElement(f,i({ref:t},p))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=d;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var u=2;u<a;u++)i[u]=n[u];return s.createElement.apply(null,i)}return s.createElement.apply(null,n)}d.displayName="MDXCreateElement"},98148:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return c},default:function(){return h},frontMatter:function(){return o},metadata:function(){return u},toc:function(){return l}});var s=n(87462),r=n(63366),a=(n(67294),n(3905)),i=["components"],o={id:"specs",title:"5. Specs",sidebar_label:"5. Specs",slug:"/tutorial/specs"},c=void 0,u={unversionedId:"tutorial/specs",id:"tutorial/specs",title:"5. Specs",description:"Introduction to the Specs concept",source:"@site/docs/tutorial/specs.md",sourceDirName:"tutorial",slug:"/tutorial/specs",permalink:"/docs/tutorial/specs",editUrl:"https://github.com/herbsjs/herbsjs.github.io/blob/master/docs/tutorial/specs.md",tags:[],version:"current",frontMatter:{id:"specs",title:"5. Specs",sidebar_label:"5. Specs",slug:"/tutorial/specs"},sidebar:"sidebar",previous:{title:"4. Working with Use Cases",permalink:"/docs/tutorial/working-usecases"},next:{title:"6. Repositories",permalink:"/docs/tutorial/repositories"}},p={},l=[{value:"Introduction to the Specs concept",id:"introduction-to-the-specs-concept",level:2},{value:"createList.spec",id:"createlistspec",level:2}],d={toc:l};function h(e){var t=e.components,o=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,s.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"introduction-to-the-specs-concept"},"Introduction to the Specs concept"),(0,a.kt)("p",null,"While in use cases we have the actions that the user can use from the domain. Specs are the definition of scenarios that test the expected behavior of a use case."),(0,a.kt)("p",null,"Previously with the execution of ",(0,a.kt)("inlineCode",{parentName:"p"},"herbs update")," command, the initial code of our use cases was generated and for each of them a spec file was also generated."),(0,a.kt)("p",null,"We can find them side by side with our use cases:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"src\n\u2514\u2500\u2500 domain\n    \u2514\u2500\u2500 usecases\n        \u2514\u2500\u2500 list\n            \u251c\u2500\u2500 createList.js\n            \u2514\u2500\u2500 createList.spec.js\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Refer to ",(0,a.kt)("a",{parentName:"p",href:"/docs/specs/getting-started"},"Specs - Getting Started")," to know more.")),(0,a.kt)("p",null,"Now, let's use createList.spec.js to learn how to create scenarios that test and validate the intent of the use case createList.js , which as its name suggests, create a list."),(0,a.kt)("h2",{id:"createlistspec"},"createList.spec"),(0,a.kt)("p",null,"So, what is happening here? follow comments in the code to understand."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript"},"\n/*\n    Assert is a nodejs package thats provides a set of assertions functions,\n    see more in section: docs > specs > features > assertion\n*/\nconst assert = require('assert')\n\n/* Importing the main functions to create spec */\nconst { spec, scenario, given, check, samples } = require('@herbsjs/herbs').specs\n\n/* \n    Here we can see herbarium again! \n    just remember thats herbarium stores all metadata for our application\n*/\nconst { herbarium } = require('@herbsjs/herbarium')\n\n/* Importing the use case thats we will explore scenarios */\nconst createList = require('./createList')\n\n\n/*\n    We start a const createListSpec, thats assigned\n    with spec() function.\n\n    spec(), expects an object parameter that we will reference\n    a use case and we will describe its test scenarios.\n*/\nconst createListSpec = spec({\n\n    /* Setting createList as the use case for this spec */\n    usecase: createList,\n\n    /* \n        Here we a creating a string property, thats\n        cleary describes a scenario thats we wanna test,\n        'Create a new list when it is valid'.\n\n        And throught scenario() function we are setting\n        the scenario conditions and its assertions.\n    */\n    'Create a new list when it is valid': scenario({\n\n        /*\n            given() set to a use case of this spec,\n            a context mockup to test this scenario,\n            here is being passed request params to use case,\n            a user object for use case authorization and a injection\n            property thats contains all dependecies injections that\n            use case needs. \n\n            given() provides data for the test context of the \n            'Create a new list when it is valid' scenary\n        */\n        'Given a valid list': given({\n            request: {\n                name: 'a text',\n                description: 'a text'\n            },\n            user: { hasAccess: true },\n            injection: {\n                ListRepository: class ListRepository {\n                    async insert(list) { return (list) }\n                }\n            },\n        }),\n\n        // when: default when for use case\n        /*\n            the follow two properties assigned with\n            check() function contains asserts it will be\n            tested\n        */\n        'Must run without errors': check((ctx) => {\n            assert.ok(ctx.response.isOk)  \n        }),\n\n        'Must return a valid list': check((ctx) => {\n            assert.strictEqual(ctx.response.ok.isValid(), true)\n        })\n    }),\n\n    /*\n        Here we can see another scenary test \n    */\n    'Do not create a new list when it is invalid': scenario({\n        'Given a invalid list': given({\n            request: {\n            name: true,\n            description: true\n            },\n            user: { hasAccess: true },\n            injection: {\n                listRepository: new ( class ListRepository {\n                async insert(list) { return (list) }\n                })\n            },\n        }),\n\n        // when: default when for use case\n\n        'Must return an error': check((ctx) => {\n            assert.ok(ctx.response.isErr)\n        }),\n    }),\n})\n\nmodule.exports =\nherbarium.specs\n    .add(createListSpec, 'CreateListSpec')\n    .metadata({ usecase: 'CreateList' })\n    .spec\n")),(0,a.kt)("p",null,"Finally we can run our specs to test our application, just run\n",(0,a.kt)("inlineCode",{parentName:"p"},"npm test")," and you can see something like this:"),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(73672).Z,width:"695",height:"972"})))}h.isMDXComponent=!0},73672:function(e,t,n){t.Z=n.p+"assets/images/spec-run-test-1e8e540d3f47dfae3f9bc206f650e22c.png"}}]);